io:
  github:
    surezzzzzz:
      sdk:
        elasticsearch:
          # Search 配置
          search:
            enable: true

            # 索引配置
            indices:
              # 普通索引（无标识符，直接使用索引名）
              - name: "test_order_index"
                lazy-load: true

              # 通配符索引（无标识符，用于日期分割场景）
              - name: "test_log_*"
                date-split: true
                date-pattern: "yyyy.MM.dd"
                date-field: "createTime"
                cache-mapping: true
                lazy-load: true

              # 降级测试索引（用于端到端降级测试）
              - name: "test_downgrade_log--*"
                date-split: true
                date-pattern: "yyyy.MM.dd"
                date-field: "timestamp"
                cache-mapping: true
                lazy-load: true

              # 带别名的索引（少数场景） - 带敏感字段
              - name: "test_user_index"
                alias: test_user
                date-split: false
                cache-mapping: true
                lazy-load: true
                sensitive-fields:
                  - field: password
                    strategy: FORBIDDEN
                  - field: phone
                    strategy: MASK
                    mask-start: 3
                    mask-end: 4
                    mask-pattern: "****"
              # Secondary 数据源索引（测试多数据源路由）
              - name: "test_index_b.secondary"
                date-split: false
                cache-mapping: true
                lazy-load: true


            # Mapping 刷新配置
            mapping-refresh:
              enabled: false
              interval-seconds: 300

            # 查询限制配置
            query-limits:
              max-size: 10000
              default-size: 20
              max-offset: 10000
              ignore-unavailable-indices: true  # 测试环境开启，避免日期分割索引查询404

            # API 配置
            api:
              enabled: true
              base-path: /api
              include-score: false
              include-raw-response: true

            # 降级配置（索引路由智能降级）
            downgrade:
              enabled: true
              max-http-line-length: 4096
              max-level: 3
              enable-estimate: true
              auto-downgrade-index-count-threshold: 200

          # Route 配置
          route:
            enable: true
            default-source: primary
            sources:
              primary:
                urls: http://localhost:9200
                connect-timeout: 5000
                socket-timeout: 60000
                keep-alive-strategy: 300
                max-conn-total: 100
                max-conn-per-route: 10
                enable-connection-reuse: true
              secondary:
                urls: http://192.168.1.83:9200
                server-version: 6.2.2
                connect-timeout: 5000
                socket-timeout: 60000
                keep-alive-strategy: 300
                max-conn-total: 100
                max-conn-per-route: 10
                enable-connection-reuse: true
            rules:
              - pattern: "test_index_b.secondary"
                datasource: secondary
                type: exact
                priority: 10

logging:
  level:
    root: debug
    io.github.surezzzzzz.sdk.elasticsearch.search: DEBUG
    io.github.surezzzzzz.sdk.elasticsearch.route: DEBUG
